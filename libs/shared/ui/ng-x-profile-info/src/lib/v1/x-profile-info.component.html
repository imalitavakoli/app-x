<!-- /////////////////////////////////////////////////////////////////////// -->
<!-- state = data                                                            -->
<!-- /////////////////////////////////////////////////////////////////////// -->

<ng-template #dataTpl>
  <section
    data-cy="x-profile-info-v1_profile-info_data"
    [ngClass]="{
      'rounded-3xl': style() === 'rounded',
      'rounded-none': style() === 'sharp',
      'e-x-profile-info': showBg(),
    }"
    class="p-4"
  >
    <ng-container *ngTemplateOutlet="dataHeadTpl"></ng-container>

    <hr class="opacity-25" />

    <ng-container *ngTemplateOutlet="dataBodyTpl"></ng-container>

    <ng-container *ngTemplateOutlet="dataFootTpl"></ng-container>
  </section>
</ng-template>

<!-- data-head (head info) ///////////////////////////////////////////////// -->
<ng-template #dataHeadTpl>
  <div
    data-cy="x-profile-info-v1_profile-info_data-head"
    class="flex items-center justify-start gap-4"
  >
    @if (showIcoInfo()) {
      <svg-icon
        class="e-svg fill-eprimary text-eprimary block h-5 w-5"
        [src]="icoInfo()"
      ></svg-icon>
    }
    <div>
      <h2 class="text-lg">{{ data().fullName }}</h2>
      <span class="text-sm opacity-50">{{ data().dateOfBirth }}</span>
    </div>
  </div>
</ng-template>

<!-- data-body (main content) ////////////////////////////////////////////// -->
<ng-template #dataBodyTpl>
  <section *transloco="let t; prefix: 'x_profile_info'">
    <!-- country -->
    @if (data().country) {
      {{ t('country') }}:
      <span data-cy="x-profile-info-v1_profile-info_data-body-country">
        {{ data().country }}
      </span>
    }

    <!-- Bio -->
    @if (data().bio) {
      <p data-cy="x-profile-info-v1_profile-info_data-body-bio">
        {{ data().bio }}
      </p>
    }

    <hr class="opacity-25" />

    <!-- Balance -->
    <div
      data-cy="x-profile-info-v1_profile-info_data-body-balance"
      class="my-2"
    >
      {{ t('balance') }}:
      {{
        creditDetail().balance
          | currencyV1: creditDetail().balanceCurrency : langCultureCode()
      }}
    </div>
  </section>
</ng-template>

<!-- data-foot (actions) /////////////////////////////////////////////////// -->
<ng-template #dataFootTpl>
  <div
    *transloco="let t; prefix: 'x_profile_info'"
    data-cy="x-profile-info-v1_profile-info_data-foot"
    class="flex justify-stretch gap-4"
  >
    <button
      data-cy="x-profile-info-v1_profile-info_data-btn-change-style"
      class="e-btn bg-eprimary hover:bg-eprimary-lighter w-full p-2"
      [aria-label]="t('btn_change_style')"
      [title]="t('btn_change_style')"
      (click)="onClickedStyle()"
    >
      <i class="bi bi-circle-square"></i>
    </button>

    @if (showBtnReadMore()) {
      <button
        data-cy="x-profile-info-v1_profile-info_data-btn-read-more"
        class="e-btn bg-eprimary hover:bg-eprimary-lighter w-full p-2"
        [aria-label]="t('btn_read_more')"
        [title]="t('btn_read_more')"
        (click)="clickedReadMore.emit()"
      >
        <i class="bi bi-book"></i>
      </button>
    }
  </div>
</ng-template>

<!-- /////////////////////////////////////////////////////////////////////// -->
<!-- state = loading                                                         -->
<!-- /////////////////////////////////////////////////////////////////////// -->

<ng-template #loadingTpl>
  <div
    data-cy="x-profile-info-v1_profile-info_loading"
    class="skeleton h-52"
  ></div>
</ng-template>

<!-- /////////////////////////////////////////////////////////////////////// -->
<!-- STRUCTURE                                                               -->
<!-- /////////////////////////////////////////////////////////////////////// -->

@if (state() === 'data') {
  <ng-container *ngTemplateOutlet="dataTpl"></ng-container>
} @else if (state() === 'loading') {
  <ng-container *ngTemplateOutlet="loadingTpl"></ng-container>
}
