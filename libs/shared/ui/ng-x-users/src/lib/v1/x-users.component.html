<!-- /////////////////////////////////////////////////////////////////////// -->
<!-- state = data                                                            -->
<!-- /////////////////////////////////////////////////////////////////////// -->

<ng-template #dataTpl>
  <section data-cy="x-users-v1_users_data">
    <div class="e-dropdown f8-dropdown w-full">
      <button
        xToggleMeV1
        data-cy="x-users-v1_users_data-btn-dropdown"
        class="e-dropdown__btn e-btn"
        [target]="dropdown"
        [closer]="dropdownList"
        [isOpen]="false"
        targetOpenClass="f8-dropdown__container--state-open"
        [title]="curr()?.name"
      >
        <span class="pointer-events-none truncate">
          {{ curr()?.name }}
        </span>
        <i class="bi bi-chevron-down pointer-events-none"></i>
      </button>
      <div
        #dropdown
        class="e-dropdown__container u8-pretty-scroll f8-dropdown__container f8-dropdown__container--effect-zoomer"
      >
        <!-- List ////////////////////////////////////////////////////////// -->
        <ul data-cy="x-users-v1_users_data-list" class="e-list" #dropdownList>
          @for (entity of users(); track $index) {
            <li>
              <input
                data-cy="x-users-v1_users_data-list-item-input"
                class="e-list__input"
                [id]="entity.id"
                type="radio"
                name="entity"
                role="combobox"
                [attr.aria-label]="entity.name"
                [checked]="curr()?.id === entity.id"
                (change)="onSelectedUser(entity)"
              />
              <label [for]="entity.id" class="e-list__btn">
                {{ entity.name }}
              </label>
            </li>
          }
        </ul>
      </div>
    </div>
  </section>
</ng-template>

<!-- /////////////////////////////////////////////////////////////////////// -->
<!-- state = loading                                                         -->
<!-- /////////////////////////////////////////////////////////////////////// -->

<ng-template #loadingTpl>
  <div data-cy="x-users-v1_users_loading" class="skeleton h-4"></div>
</ng-template>

<!-- /////////////////////////////////////////////////////////////////////// -->
<!-- STRUCTURE                                                               -->
<!-- /////////////////////////////////////////////////////////////////////// -->

@if (state() === 'data') {
  <ng-container *ngTemplateOutlet="dataTpl"></ng-container>
} @else if (state() === 'loading') {
  <ng-container *ngTemplateOutlet="loadingTpl"></ng-container>
}
